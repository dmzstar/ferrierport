<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{layout/admin :: layout(~{::title}, ~{::content})}">
<head>
<title>权限管理</title>

</head>
<body>
	<content>

	<table id="exampleDataTable" class="table table-striped table-bordered"
		style="width: 100%">

		<thead>
			<tr>
				<th>Id</th>
				<th>用户名</th>
				<th>操作</th>
			</tr>
		</thead>

	</table>

	<div id="dlg" style="display: none;">

		<form>
			<div class="form-group">
				<label for="exampleInputEmail1">Id</label>
				<span>1</span>
			</div>
			<div class="form-group">
				<label for="exampleInputEmail1">用户名</label> <input type="email"
					class="form-control" id="exampleInputEmail1" placeholder="Email" value="{{username}}">
			</div>
			<div class="form-group">
				<label for="exampleInputPassword1">密码</label> <input type="password"
					class="form-control" id="exampleInputPassword1"
					placeholder="Password">
			</div>
			<button type="submit" class="btn btn-default">Submit</button>
		</form>

	</div>
	<button id="btn-show" type="button">Show</button>

	<script type="text/javascript"
		th:src="@{/assets/oop/underscore-min.js}"></script> <script
		type="text/javascript" th:src="@{/assets/oop/backbone-min.js}"></script>
	<script type="text/javascript" th:src="@{/assets/oop/mustache.min.js}"></script>

	<link rel="stylesheet"
		th:href="@{/primeui-4.1.15/themes/bootstrap/theme.css}" />
	<link rel="stylesheet" th:href="@{/jquery-ui-1.11.4/jquery-ui.css}" />
	<link rel="stylesheet" th:href="@{/primeui-4.1.15/primeui.min.css}" />
	<script type="text/javascript"
		th:src="@{/jquery-ui-1.11.4/jquery-ui.js}"></script> <script
		type="text/javascript" th:src="@{/primeui-4.1.15/primeui.min.js}"></script>
	<script type="text/javascript" th:src="@{/x-tag/x-tag-core.min.js}"></script>
	<script type="text/javascript"
		th:src="@{/primeui-4.1.15/primeelements.min.js}"></script>

	<link rel="stylesheet"
		href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" />
	<script
		src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
	<script
		src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>

	<script>
		$(document).ready(function() {

			var $datatable = $('#exampleDataTable').dataTable({
				"processing" : true,
				"serverSide" : true,
				"columnDefs" : [ {
					"targets" : [ 2 ],
					"data" : null,
					"render" : function(data, type, row) {
						return $('#exampleDataTableRowCommonColumn').html();
					}
				} ],
				"ajax" : "/admin/api/secs"
			});			
			
			$datatable.delegate(".selEditCommand","click",function(){
				
				$('#dlg').puidialog('show');
			});
			
			

			var columnView = Backbone.View.extend({
				el : '#exampleDataTableRowCommonColumn'
			});
			
			var userData = null;

			var UserEditView = Backbone.View.extend({
				el : '#dlg',
				render: function() {
					var html = Mustache.render(this.$el.find('form').html(),userData);
				    this.$el.find('form').html(html);
				    return this;
				 }
			});
			
			var userEditView = new UserEditView();

			$('#dlg').puidialog({
				showEffect : 'fade',
				hideEffect : 'fade',
				minimizable : true,
				maximizable : true,
				responsive : true,
				minWidth : 200,
				modal : true,
				title : '编辑用户',
				beforeShow : function(){
					$.get('/admin/api/secs/user/2',function(resp){
						userData = resp;
						userEditView.render();
					});
				}
			});

			$('#btn-show').puibutton({
				icon : 'fa-external-link-square',
				click : function() {
					$('#dlg').puidialog('show');
				}
			});

		});
	</script> 
	<script type="type=text/template" id="exampleDataTableRowCommonColumn">
		<a href="javascript:void(0)" class="selEditCommand">编辑</a>
			
		<a href="">删除</a>
	</script> 
	</content>
</body>
</html>